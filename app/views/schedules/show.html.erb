<ul class="nav nav-pills">
<li><%= link_to 'Add event', new_schedule_event_path(@schedule) %></li>
<li><%= link_to 'Add room', new_schedule_room_path(@schedule) %></li>
<li><%= link_to 'Edit', edit_schedule_path(@schedule) %></li>
<li><%= link_to 'Anneal', anneal_schedule_path(@schedule), id: 'anneal' %></li>
</div>
<p id="notice"><%= notice %></p>
<small class="pull-right">energy: <%= number_with_precision @schedule.energy, precision: 0, delimiter: ',' %></small>
<h1><%= @schedule.title %></h1>
<div class="row">
  <% @schedule.rooms.sort_by(&:name).each do |r| %>
    <div class="col-md-<%= 12 / @schedule.rooms.length %>">
      <h2><%= r.name %><small class="pull-right"><%= link_to 'edit', [:edit, @schedule, r] %></small></h2>
    </div>
  <% end %>
</div>

<% @schedule.events.group_by { |x| x.time }.sort_by { |time, events| time }.each do |t, events| %>
  <div class="row">
    <% @schedule.rooms.sort_by(&:name).each do |r| %>
      <div class="col-md-<%= 12 / @schedule.rooms.length %>">
        <% e = events.select { |x| x.room == r }.first %>
        <%= render partial: 'event', object: e if e  %>
      </div>
    <% end %>
  </div>
<% end %>

<% unassigned = @schedule.events.select { |x| x.room.nil? } %>
<% unless unassigned.empty? %>
  <h2>Unassigned</h2>
  <% unassigned.sort_by { |x| x.time }.each do |e| %>
  <div class="col-md-4">
    <%= render partial: 'event', object: e %>
  </div>
  <% end %>
<% end %>
